## 简单分析
1. URL解析
2. DNS查询
3. TCP连接
4. HTTP请求
5. 响应请求
6. 页面渲染

## 详细分析
### URL解析
浏览器根据用户输入的URL，来判断输入的是否是合法的URL地址还是搜索的关键词，从而解析出对应的IP地址     
一个合法的URL包含:
  - 协议：`http`或者`https`
  - 域名/具体的IP地址
  - 端口号：确定具体的应用，缺省端口80
  - 路径：访问的资源位置
  - 详情描述：查询字符串/锚点链接  
比如: `https://www.baidu.com/newspage/data/landingsuper?context=xxxxxxx`


### DNS域名解析
浏览器对输入的网站URL域名解析成对应的服务器IP地址，是由DNS服务完成的。   
客户端接收到域名地址后，首先去本地的hosts文件查找文件中有没有相应的域名和IP地址，如果有的话，直接向该IP地址发送请求，没有的话再去找DNS服务器。    
找到IP地址后，客户端就需要和相应的IP服务器进行连接 --- TCP/IP连接。    
### TCP连接
**TCP连接 - 三次握手，四次挥手**
三次握手过程：客户端发送一个带有SYN标志的数据包给到服务端，服务端收到后，会传一个带有SYN/ACK标志的数据包给客户端表示确认，最后客户端再传一个带ACK标志的数据包给服务端表示连接成功。

### HTTP请求
客户端与服务器建立连接后，就开始发送HTTP请求了。我们一般在网页的network中可以看到各种资源的请求，请求中可以看到请求一系列的报文。   
**Request Headers**中包括请求的方式、URI、HTTP的版本、缓存协议等等。

### 服务器处理请求
服务器接受到请求后，开始处理http的请求，开始解析客户端需要哪些资源文件，通过资源文件来处理用户的请求和参数，并调用数据库信息，最后把结果通过web服务器返回给客户端。
### 服务器返回响应结果
在network中我们也可以看到各种资源请求的响应结果内容   
**Response**结果，里面包括HTTP状态码、响应数据等。

### 关闭TCP连接
四次挥手的过程：当客户端与服务器之间没有任何请求和响应传递了之后，就会开始发送关闭请求了，就会有4次挥手的过程。  
简单理解过程就是：  
  1. 客户端：我这里没有东西给你了，这次通话就这样吧。
  2. 服务端：收到！我再检查一下还有没有东西给你。
  3. 客户端：好的。
  4. 服务端：我这也没有东西给你了，咱可以关闭连接了。
  5. 客户端：好咧！

### 页面渲染
- 解析HTML，构建 DOM 树
- 解析 CSS ，生成 CSS 规则树
- 合并 DOM 树和 CSS 规则，生成 render 树
- 布局 render 树（ Layout / reflow ），负责各元素尺寸、位置的计算
- 绘制 render 树（ paint ），绘制页面像素信息
- 浏览器会将各层的信息发送给 GPU，GPU 会将各层合成（ composite ），显示在屏幕上


<!-- ### 浏览器解析HTML、JS、CSS
浏览器开始加载解析HTML、JS、CSS等资源文件。   
浏览器解析HTML文本生成DOM树，解析CSS样式文本解析成styleSheet，然后通过DOM树和CSSOM生成渲染树，渲染图层展示页面。   
解析CSSOM的过程成不会阻塞DOM的构建，但是解析JS的过程会停止DOM的解析，先进行JS的加载（如果是外部的js文件的话，也是先加载js文件，解析js内容）完成之后，再继续解析DOM和CSSOM。如果是外部CSS文件的情况下，如果在JS中访问到了某个元素的样式，这个时候就需要等待这个样式被下载完成才能继续向下执行，这种情况下，CSS也会阻塞DOM的解析。

### 浏览器的布局渲染
当浏览器解析完成之后，根据渲染树进行CSS样式计算来布局，浏览器通过自身的渲染进程将HTML、CSS、JS转换为用户可以交互的页面，展示给用户。 -->


<!-- 1. 用户输入url
2. 浏览器根据url查找IP地址(这部分展开说明查找IP地址的过程，DNS等)
3. 建立TCP连接(可以细讲TCP/IP连接)
4. 浏览器向web服务器发送HTTP请求(可以细讲http内容)
5. 服务端进行处理请求
6. 关闭TCP连接
7. 浏览器解析资源(浏览器如何解析HTML、CSS、JS资源？)
8. 浏览器布局渲染展示页面




<!-- 1. 什么是TCP/IP协议? -->


<!-- ## 浏览器的工作原理
### 打开一个页面浏览器一共使用了几个进程
- 打开一个页面浏览器需要1个网络进程，1个浏览器进程，1个GPU进程，1个渲染进程。如果打开的页面有运行插件的话，还有1个插件进程
  1. 网络进程：主要负责页面网络资源加载
  2. 浏览器进程：主要负责页面显示，用户交互，子进程管理，提供存储等
  3. GPU进程：主要负责页面的UI界面绘制
  4. 渲染进程：主要负责将HTML、CSS、JS转换为用户可以交互的网页。Chrome浏览器会给每个Tab标签都创建一个渲染进程
  5. 插件进程：主要负责页面中所需要的插件的运行。因为插件容易崩溃，所以使用了一个插件进程来隔离，来保证浏览器和页面的正常运行


优点：提成了浏览器的稳定性、流畅性和安全性   
缺点：更高的资源占用、更复杂的体系架构


### 在浏览器中，从输入URL到页面展示，这中间都发生了些什么？
1. 用户输入了URL后到页面开始解析过程 - 称之为导航
  - 浏览器进程接受到输入的URL请求，便将这个URL转发给了网络进程
  - 在网络进程中发起真正的请求
  - 然后网络进程接收到了响应头数据，便开始解析响应头数据，并将数据转发给浏览器进程
  - 浏览器进程接收到网络进程的响应头数据后，发送消息给渲染进程
  - 渲染进程接收到浏览器进程的消息后，开始接收HTML数据
  - 最后渲染进程和浏览器进程通信，告知浏览器进程，已准备好接收并解析页面数据了
  - 浏览器进程接收到渲染进程的消息之后，便开始更新浏览器进程中的页面状态

2. 浏览器是如何将HTML、CSS、JS变成页面的？
一开始中我们就讲到，HTML、CSS、JS是由浏览器的渲染进程处理的，因此
  - 在渲染进程中，我们可以把执行过程划分为如下多个阶段：**DOM输的构建、样式的计算、布局、分层、绘制、分块、光栅化以及合成**
    - 构建DOM树：我们都知道浏览器为把HTML的标签文本内容转成DOM数结构，这是因为浏览器不能直接理解和使用这些HTML标签和文本，因此才需要转成浏览器能理解的结构
    - 样式计算：HTML中样式一般有3种写法（**link标签引入外部CSS文件、head中style标签内的CSS、元素上style属性内嵌的CSS**），这些内容浏览器也是无法直接使用的，所以浏览器会将这些样式文本转换成styleSheets，其中还会涉及到**CSS选择器的优先级，继承**等一系列的计算
    - 布局：有了DOM树和styleSheets属性，浏览器就会计算出DOM树中有哪些DOM是需要展示的，哪些是需要隐藏的以及DOM的位置、颜色、字体、字体大小等等，这个过程中浏览器有2个任务：创建布局和计算布局
    - 分层：



### Thinking： 
  1. 如果下载 CSS 文件阻塞了，会阻塞 DOM 树的合成吗？会阻塞页面的显示吗？ -->